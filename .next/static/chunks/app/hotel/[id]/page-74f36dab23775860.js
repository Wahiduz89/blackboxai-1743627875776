(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[410],{7436:function(e,t,s){Promise.resolve().then(s.bind(s,3083)),Promise.resolve().then(s.t.bind(s,1749,23))},3083:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var n=s(7437),r=s(2265),a=s(2749),i=s(4033);function o(e){let{hotel:t}=e,{data:s}=(0,a.useSession)(),o=(0,i.useRouter)(),[c,l]=(0,r.useState)(""),[d,u]=(0,r.useState)(""),[m,f]=(0,r.useState)(1),[g,h]=(0,r.useState)(!1),[x,b]=(0,r.useState)(""),[p,y]=(0,r.useState)(!1),j=async e=>{if(e.preventDefault(),!s){o.push("/auth/signin");return}let n=new Date(c),r=new Date(d),a=new Date;if(a.setHours(0,0,0,0),n<a){b("Check-in date cannot be in the past");return}if(r<=n){b("Check-out date must be after check-in date");return}h(!0),b(""),y(!1);try{let e=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hotelId:t.id,checkIn:c,checkOut:d,guests:m,totalPrice:N()})});if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to create booking")}y(!0),setTimeout(()=>{o.push("/bookings"),o.refresh()},2e3)}catch(e){b(e instanceof Error?e.message:"Failed to create booking. Please try again.")}finally{h(!1)}},N=()=>{if(!c||!d)return 0;let e=new Date(c),s=Math.ceil((new Date(d).getTime()-e.getTime())/864e5);return t.price*s},k=new Date().toISOString().split("T")[0];return(0,n.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold mb-6",children:"Book Your Stay"}),(0,n.jsxs)("form",{onSubmit:j,className:"space-y-6",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"checkIn",className:"block text-gray-700 mb-2 font-medium",children:"Check-in Date"}),(0,n.jsx)("input",{type:"date",id:"checkIn",value:c,onChange:e=>{l(e.target.value),b("")},min:k,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"checkOut",className:"block text-gray-700 mb-2 font-medium",children:"Check-out Date"}),(0,n.jsx)("input",{type:"date",id:"checkOut",value:d,onChange:e=>{u(e.target.value),b("")},min:c||k,required:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"guests",className:"block text-gray-700 mb-2 font-medium",children:"Number of Guests"}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("button",{type:"button",onClick:()=>m>1&&f(m-1),className:"px-3 py-2 border border-gray-300 rounded-l-md hover:bg-gray-100",children:(0,n.jsx)("i",{className:"fas fa-minus"})}),(0,n.jsx)("input",{type:"number",id:"guests",value:m,onChange:e=>f(parseInt(e.target.value)),min:1,max:10,required:!0,className:"w-20 px-3 py-2 border-y border-gray-300 text-center focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"}),(0,n.jsx)("button",{type:"button",onClick:()=>m<10&&f(m+1),className:"px-3 py-2 border border-gray-300 rounded-r-md hover:bg-gray-100",children:(0,n.jsx)("i",{className:"fas fa-plus"})})]})]}),c&&d&&(0,n.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)("span",{className:"text-gray-600",children:["Total for ",Math.ceil((new Date(d).getTime()-new Date(c).getTime())/864e5)," nights"]}),(0,n.jsxs)("span",{className:"text-xl font-bold text-indigo-600",children:["$",N().toFixed(2)]})]})}),x&&(0,n.jsxs)("div",{className:"bg-red-50 text-red-500 p-3 rounded-md text-sm",children:[(0,n.jsx)("i",{className:"fas fa-exclamation-circle mr-2"}),x]}),p&&(0,n.jsxs)("div",{className:"bg-green-50 text-green-500 p-3 rounded-md text-sm",children:[(0,n.jsx)("i",{className:"fas fa-check-circle mr-2"}),"Booking successful! Redirecting to your bookings..."]}),(0,n.jsx)("button",{type:"submit",disabled:g||p,className:"w-full py-3 px-4 rounded-md text-white font-medium transition-colors ".concat(g||p?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700"),children:g?(0,n.jsxs)("span",{className:"flex items-center justify-center",children:[(0,n.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Processing..."]}):p?(0,n.jsxs)("span",{className:"flex items-center justify-center",children:[(0,n.jsx)("i",{className:"fas fa-check mr-2"}),"Booked Successfully"]}):"Book Now"}),!s&&(0,n.jsxs)("p",{className:"text-sm text-gray-500 text-center mt-4",children:[(0,n.jsx)("i",{className:"fas fa-info-circle mr-1"}),"You need to sign in to make a booking"]})]})]})}},4033:function(e,t,s){e.exports=s(5313)}},function(e){e.O(0,[873,749,971,938,744],function(){return e(e.s=7436)}),_N_E=e.O()}]);